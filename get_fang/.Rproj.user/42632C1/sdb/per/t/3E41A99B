{
    "collab_server" : "",
    "contents" : "####################################\n# project name: getData_courDoc\n# author: hyx\n# date:2016.12.9-2016.12.\n# key words: web scrapy js R   RSelenium\n# version: v1.0.0\n# ####################################\n# Questions&next version:\n# ####Q1: next page\n# ####Q2: executeJavaScript\n\n######################################\n\n\n\n###rm(list=ls())\n###ctrl+shift+c段落注释\n\n#library(JQuery)\nlibrary(httr)\nlibrary(rvest)\nlibrary(RSelenium)\n\nsite <- \"http://wenshu.court.gov.cn/list/list/?sorttype=1&conditions=searchWord+002005002+AY++%E6%A1%88%E7%94%B1:%E7%9F%A5%E8%AF%86%E4%BA%A7%E6%9D%83%E6%9D%83%E5%B1%9E%E3%80%81%E4%BE%B5%E6%9D%83%E7%BA%A0%E7%BA%B7&conditions=searchWord+all_%E4%B8%80%E5%AE%A1+SPCX++%E5%AE%A1%E5%88%A4%E7%A8%8B%E5%BA%8F:%E4%B8%80%E5%AE%A1&conditions=searchWord+2014+++%E8%A3%81%E5%88%A4%E5%B9%B4%E4%BB%BD:2014&conditions=searchWord+%E5%88%A4%E5%86%B3%E4%B9%A6+++%E6%96%87%E4%B9%A6%E7%B1%BB%E5%9E%8B:%E5%88%A4%E5%86%B3%E4%B9%A6\"\nremDr <- remoteDriver(remoteServerAddr = \"localhost\" \n                      , port = 4444\n                      , browserName = \"chrome\"\n)\nremDr$open()\n#remDr$setWindowSize()\n#tryCatch(remDr$navigate(site))\nremDr$navigate(site)\ndata <- data.frame()\nfor(i in 1:2796)\n {\n   ####20 records\n   #webElem_btn <- remDr$findElement(using = 'css selector', \"#pageNumber > div:nth-child(9) > div:nth-child(1) > table:nth-child(1) > tbody:nth-child(1) > tr:nth-child(1) > td:nth-child(2)\")\n   #webElem_btn$clickElement() \n   #webElem_page20 <- remDr$findElement('xpath', \"//li[@id = '16_input_20']\")\n   #webElem_page20$clickElement() \n   ####\n   webElems_title <- remDr$findElements(using = 'css selector', \"div.wstitle\")\n   doc_title <- unlist(lapply(webElems_title, function(x){x$getElementText()}))\n   #doc_url <- unlist(lapply(webElems, function(x){x$getElementAttribute(\"href\")}))\n   #print(resHeaders)\n   #webElems <- remDr$findElements(value = \"//tbody//tr//td//div//a\")  \n\n   webElems_num <- remDr$findElements(using = 'css selector', \"div.fymc\")\n   doc_num <- unlist(lapply(webElems_num, function(x){x$getElementText()}))\n   \n   \n   webElems_url <- remDr$findElements(using = 'css selector', \"td:nth-child(1) > div:nth-child(1) > a:nth-child(3)\")\n   doc_url <- unlist(lapply(webElems_url, function(x){x$getElementAttribute(\"href\")}))\n   #print(doc_url)\n   #title_url <- data.frame(resHeaders,doc_url)\n   while ((is.null(doc_title)) | (is.null(doc_url)))\n   {\n    #remDr$refresh()\n     Sys.sleep(10)\n     webElems_title <- remDr$findElements(using = 'css selector', \"div.wstitle\")\n     doc_title <- unlist(lapply(webElems_title, function(x){x$getElementText()}))\n     #doc_url <- unlist(lapply(webElems, function(x){x$getElementAttribute(\"href\")}))\n     #print(resHeaders)\n     #webElems <- remDr$findElements(value = \"//tbody//tr//td//div//a\")  \n     \n     webElems_num <- remDr$findElements(using = 'css selector', \"div.fymc\")\n     doc_num <- unlist(lapply(webElems_num, function(x){x$getElementText()}))\n     \n     \n     webElems_url <- remDr$findElements(using = 'css selector', \"td:nth-child(1) > div:nth-child(1) > a:nth-child(3)\")\n     doc_url <- unlist(lapply(webElems_url, function(x){x$getElementAttribute(\"href\")}))\n     \n    #    #print(111111)\n    #    webElems_title <- remDr$findElements(using = 'css selector', \"div.wstitle\")\n    #    resHeaders <- unlist(lapply(webElems_title, function(x){x$getElementText()}))\n    #    #doc_url <- unlist(lapply(webElems, function(x){x$getElementAttribute(\"href\")}))\n    #    #print(resHeaders)\n    #    webElems <- remDr$findElements(value = \"//tbody//tr//td//div//a\")  \n    #    webElems_url <- remDr$findElements(using = 'css selector', \"td:nth-child(1) > div:nth-child(1) > a:nth-child(3)\")\n    #    doc_url <- unlist(lapply(webElems_url, function(x){x$getElementAttribute(\"href\")}))\n    #    #print(doc_url)\n    #    #title_url2 <- data.frame(resHeaders,doc_url)\n    #    \n    #    #remDr$setTimeout(10000)\n    #  \n   }\n   title_num_url <- data.frame(doc_title,doc_num,doc_url)\n   data <- rbind(data,title_num_url)\n   #print(data)\n   webElem_nextPage <- remDr$findElement(using = 'css selector', \"a.next\")\n   # print(111).next\n   webElem_nextPage$clickElement()\n   Sys.sleep(3)\n\n   #url_get <- rbind(url_get,title_url)\n  #  script <- \"return document.getElementById('hplogo').hidden;\"\n  #  remDr$executeScript(script, args = list())\n  # #data <- rbind(data,getURL())\n# \n  #  script1 <-  \"http://wenshu.court.gov.cn/Assets/js/libs/js/nav/pageNumber.js:171\"\n  #  script2 <-  \"http://wenshu.court.gov.cn/Assets/js/dist/libs/jquery-1.9.0.min.js:2\"\n  # remDr$executeScript(script1, args = list())\n  #  remDr$executeScript(script2, args = list())\n}\n# webElems_title_last <- remDr$findElements(using = 'css selector', \"div.wstitle\")\n# doc_title_last <- unlist(lapply(webElems_title_last, function(x){x$getElementText()}))\n# webElems_url_last <- remDr$findElements(using = 'css selector', \"td:nth-child(1) > div:nth-child(1) > a:nth-child(3)\")\n# doc_url_last <- unlist(lapply(webElems_url_last, function(x){x$getElementAttribute(\"href\")}))\n# data_last <- data.frame(resHeaders_last,doc_url_last)\n# data <- rbind(data,data_last)\n#data\nwrite.csv(data,\"title_url2.csv\")\n\n",
    "created" : 1513957125974.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3291928946",
    "id" : "3E41A99B",
    "lastKnownWriteTime" : 1481301763,
    "last_content_update" : 1481301763,
    "path" : "~/R codes/getData_courtDoc/get_URL.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}